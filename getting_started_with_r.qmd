# Introdu√ß√£o ao R

```{r}
#| echo: false
source(file = "_common.R")
linux_logo <- fontawesome::fa(name = "linux")
macos_logo <- fontawesome::fa(name = "apple")
windows_logo <- fontawesome::fa(name = "windows")
```

Para come√ßar a usar o `r r_logo`, voc√™ precisar√° baixar uma c√≥pia do `r r_logo` e tamb√©m do RStudio IDE, um ambiente de desenvolvimento integrado (IDE) gratuito, que simplifica o uso do `r r_logo`. Tanto o `r r_logo` quanto o RStudio IDE s√£o de c√≥digo aberto, o que significa que n√£o h√° custos de licenciamento envolvidos.

Antes de descrever o processo de instala√ß√£o, √© importante entender como o `r r_logo` e o RStudio IDE funcionam juntos, e tamb√©m como estender sua funcionalidade usando pacotes e outros softwares complementares. [@ismay_statistical_2020, cap. 1] fornecem uma excelente explica√ß√£o pedag√≥gica desses conceitos. Esta se√ß√£o se baseia na abordagem deles e utiliza as mesmas analogias.

## R e RStudio IDE

O `r r_logo` √© como o motor de um carro, enquanto o RStudio IDE funciona como o volante e o painel, conforme ilustrado na @fig-r-vs-rstudio-ide-1. Assim como um motorista interage principalmente com o volante e o painel para controlar o carro, raramente precisando interagir diretamente com o motor, o RStudio IDE tamb√©m oferece uma interface amig√°vel para trabalhar com o poderoso mecanismo do `r r_logo`. Essa interface simplifica o processo de usar o `r r_logo` para suas tarefas.

::: {#fig-r-vs-rstudio-ide-1 layout="[[49, -2, 49]]"}
![R: Motor](images/engine.png){#fig-r-1}

![RStudio IDE: Painel](images/dashboard.png){#fig-rstudio-ide-1}

Analogia da diferen√ßa entre `r r_logo` e RStudio IDE
:::

## Como baixar e instalar o R

Para obter uma c√≥pia e a vers√£o oficial mais recente do `r r_logo`, acesse [The Comprehensive R Archive Network (CRAN)](https://cran.r-project.org/). O `r r_logo` √© desenvolvido para as fam√≠lias de sistemas operacionais Unix, Windows e Mac. Na CRAN, voc√™ encontrar√° 3 links para baixar o `r r_logo` para Linux, macOS ou Windows:

-   `r linux_logo`: Clique em **Download R for Linux**, escolha sua distribui√ß√£o e siga as instru√ß√µes de instala√ß√£o espec√≠ficas para sua distribui√ß√£o.

-   `r macos_logo`: Clique em **Download R for macOS**. Selecione o instalador que corresponda √† sua vers√£o do macOS, abra-o e siga as instru√ß√µes na tela.

-   `r windows_logo`: Clique em **Download R for Windows** e, em seguida, clique em **base**. Depois, clique no primeiro link no topo da nova p√°gina e execute o instalador. O instalador ir√° gui√°-lo atrav√©s do processo de instala√ß√£o.

## Como baixar e instalar o RStudio IDE

Para obter a vers√£o oficial mais recente do RStudio IDE, acesse <https://posit.co/download/rstudio-desktop/>. Role a p√°gina para baixo, selecione seu sistema operacional e baixe o instalador apropriado. Abra o instalador e siga as instru√ß√µes fornecidas.

Agora que voc√™ instalou o `r r_logo` e o RStudio IDE, voc√™ est√° pronto para come√ßar a trabalhar no RStudio IDE. Assim como voc√™ interage principalmente com o volante e o painel de um carro em vez do motor, voc√™ focar√° em usar a interface do RStudio IDE para trabalhar com o `r r_logo`.

Ao abrir o RStudio IDE, voc√™ pode criar um novo script `r r_logo` selecionando **File \> New File \> R Script** ou usando o atalho de teclado **Ctrl + Shift + N**. Voc√™ ver√° quatro pain√©is principais na interface, como mostrado na @fig-rstudio-ide-panels:

-   **Painel 1**: √â onde voc√™ escreve, edita e salva seu c√≥digo R.
-   **Painel 2**: Aqui voc√™ pode digitar os comandos do R e ver os resultados.
-   **Painel 3**: Este painel mostra os objetos do R (como vari√°veis ou dados) que voc√™ criou durante a sess√£o atual.
-   **Painel 4**: V√°rios elementos de sa√≠da, incluindo arquivos, gr√°ficos e documentos de ajuda, s√£o exibidos aqui.

![Pain√©is do RStudio IDE](images/panels_rstudio_ide.png){#fig-rstudio-ide-panels}

### Configurar e personalizar o RStudio IDE

Para personalizar seu espa√ßo de trabalho, acesse **Tools \> Global Options**. Em seguida:

-   Sempre inicie o `r r_logo` com uma sess√£o em branco, @fig-r-blank-slate:

![Configura√ß√£o do espa√ßo de trabalho](images/r_blank slate.png){#fig-r-blank-slate}

-   Use o operador de pipe nativo, `|>`, @fig-native-pipe-operator:

![Configura√ß√£o para usar o operador de pipe nativo](images/native_pipe_operator.png){#fig-native-pipe-operator}

-   Ajuste o tamanho da fonte e selecione um tema escuro, @fig-font-size-dark-theme:

![Configura√ß√£o para usar um tema escuro](images/font_size_dark_theme.png){#fig-font-size-dark-theme}

A aplica√ß√£o dessas mudan√ßas personalizar√° sua experi√™ncia com o RStudio IDE, como mostrado na @fig-customize-rstudio-ide.

![Resultado da aplica√ß√£o da configura√ß√£o completa](images/customize_rstudio_ide.png){#fig-customize-rstudio-ide}

## Executar c√≥digo usando o RStudio IDE

Para nos comunicarmos com uma m√°quina, escrevemos instru√ß√µes em uma linguagem especializada chamada c√≥digo. Este c√≥digo √© ent√£o traduzido em um formato que a m√°quina entende, permitindo que ela execute as tarefas que definimos.

Vamos come√ßar com um exemplo simples! Digite `1 + 2 + 3 + 4 + 5 + 6`, como mostrado na @fig-executing-code-example, e ent√£o aperte Enter para ver o que acontece!

![Executando c√≥digo no console](images/executing_code_example.png){#fig-executing-code-example}

Se voc√™ seguiu as instru√ß√µes certinho, o RStudio IDE vai mostrar o seguinte resultado:

```{r}
1 + 2 + 3 + 4 + 5 + 6
```

Ao executar o c√≥digo, voc√™ pode encontrar mensagens , avisos ou erros. N√£o entre em p√¢nico! Estas s√£o maneiras do seu computador se comunicar com voc√™:

-   **Mensagem (Message)**: √â simplesmente uma nota informativa. Seu c√≥digo ainda ser√° executado sem problemas.

-   **Aviso (Warning)**: Alerta voc√™ sobre potenciais resultados inesperados, mas seu c√≥digo ainda ser√° executado.

-   **Erro (Error)**: Indica um problema fundamental que impede o seu c√≥digo de ser executado. Voc√™ precisar√° corrigir o problema para que seu c√≥digo possa funcionar.

Mais adiante, voc√™ usar√° o comando `install.packages()`, onde poder√° encontrar mensagens. Para avisos ou erros, tente os seguintes comandos para ilustrar as diferen√ßas:

```{r}
log(x = -1)
```

```{r}
#| error: true
"Tudo bem" * 2
```

No primeiro caso, o c√≥digo ser√° executado, mas voc√™ ver√° o resultado `NaN` (**Not a Number**, em ingl√™s) porque o logaritmo de um n√∫mero negativo √© indefinido. No segundo caso, seu c√≥digo n√£o ser√° executado porque o `r r_logo` n√£o permite a multiplica√ß√£o de palavras.

::: callout-note
No `r r_logo`, uma string √© uma cole√ß√£o de um ou mais caracteres e s√£o criadas usando aspas duplas, `""`. Por exemplo, `"Tudo bem"` √© uma string.
:::

## Objetos, fun√ß√µes e o operador de atribui√ß√£o

Tudo que existe no `r r_logo` √© um **objeto** [@chambers_object-oriented_2014, p. 170]. Isso significa que n√∫meros, textos e at√© mesmo instru√ß√µes para o computador s√£o todos tratados como objetos. Voc√™ manipula esses objetos usando **fun√ß√µes**, que recebem objetos como entrada e produzem novos objetos como sa√≠da.

Por exemplo, quando voc√™ soma os n√∫meros `1, 2, 3, 4, 5` e `6` (que s√£o objetos), voc√™ usa a fun√ß√£o `+` repetidamente para criar um novo objeto `21`. O `r r_logo` √© constru√≠do sobre a ideia de que objetos e fun√ß√µes trabalham juntos.

Para trabalhar com objetos de forma simples, voc√™ pode atribuir nomes a eles usando o operador `<-`. Uma vez que um objeto tenha um nome, voc√™ pode manipul√°-lo chamando esse nome.

Para entender esses conceitos de maneira pr√°tica, vamos considerar o processo de jogar uma moeda usando o `r r_logo`.

### Objeto moeda

Vamos imaginar uma moeda padr√£o com dois lados: cara e coroa, como mostrado na @fig-coin-head-tail.

![Os dois lados de uma moeda](images/coin_head_tail.png){#fig-coin-head-tail}

Para simular um lan√ßamento de moeda em `r r_logo`, primeiro precisamos criar um objeto que represente nossa moeda com seus dois lados: cara e coroa. Vamos atribuir um nome a esse objeto usando `<-`. Veja como combinar esses elementos em R usando a fun√ß√£o `c()`:

```{r}
moeda <- c("cara", "coroa")
```

::: callout-note
Para representar os dois lados da moeda, usamos duas strings: `"cara"` e `"coroa"`. Usar apenas `cara` e `coroa` sem aspas duplas poderia causar problemas, pois o `r r_logo` as interpretaria como nomes associados a alguns objetos, em vez de valores representando os dois lados da moeda.
:::

Agora que associamos um nome ao nosso objeto moeda, podemos manipul√°-lo simplesmente chamando o nome `moeda`:

```{r}
moeda
```

Quando um objeto tem um nome, ele aparecer√° na aba Ambiente (**Environment**, em ingl√™s) do painel 3 no RStudio IDE, como mostrado na @fig-panel3-environment-tab.

![Aba de ambiente](images/panel3_environment_tab.png){#fig-panel3-environment-tab}

### Jogar uma moeda

Agora que voc√™ criou um objeto no `r r_logo`, √© hora de simular o lan√ßamento de uma moeda. Uma maneira de fazer isso √© com a fun√ß√£o `sample`:

```{r}
sample(x = moeda, size = 1)
```

Aqui, o argumento `x` informa √† fun√ß√£o qual objeto usar para selecionar os elementos. O argumento `size` especifica quantos elementos escolher, neste caso `size = 1` para representar o lan√ßamento de uma √∫nica moeda.

Vamos tentar jogar a moeda duas vezes:

```{r}
sample(x = moeda, size = 2)
```

E que tal 3 vezes?

```{r}
#| error: true
#| code-overflow: wrap
sample(x = moeda, size = 3)
```

Voc√™ encontrar√° um erro. N√£o se preocupe, os erros s√£o √∫teis. A mensagem de erro menciona o argumento `replace`. Para aprender mais sobre qualquer fun√ß√£o, use `?` seguido do nome da fun√ß√£o, como `?sample`, conforme mostrado na @fig-help-sample-replace.

![Como obter ajuda no `r r_logo`](images/help_sample_replace.png){#fig-help-sample-replace}

Quando `replace = FALSE`, cada item em `x` s√≥ pode ser escolhido uma vez. Para simular v√°rios lan√ßamentos de uma moeda, em que cada resultado tem a mesma probabilidade de ser selecionado a cada vez, `replace = TRUE`:

```{r}
sample(x = moeda, size = 3, replace = TRUE)
```

Agora temos todos os componentes para construir uma fun√ß√£o na pr√≥xima se√ß√£o. Comecemos simulando quatro lan√ßamentos de uma moeda:

```{r}
lados <- c("cara", "coroa")
n_lancamentos <- 4
com_reposicao <- TRUE
lancamentos <- sample(x = lados, 
                      size = n_lancamentos, 
                      replace = com_reposicao)
lancamentos
```

::: callout-important
Para melhorar a legibilidade do c√≥digo, seguiremos estas diretrizes:

-   **Nomes de objetos**: Use apenas letras min√∫sculas sem acentos, n√∫meros e sublinhados, `_`, para nomes de objetos.

-   **Separa√ß√£o de palavras**: Utilize sublinhados para separar palavras dentro de um nome (isso √© conhecido como [snake case](https://en.wikipedia.org/wiki/Snake_case)).

-   **Nomes significativos**: Escolha nomes de objetos que reflitam com precis√£o o que eles representam.
:::

### Definindo novas fun√ß√µes

No `r r_logo`, uma fun√ß√£o tem tr√™s partes b√°sicas: um nome, um corpo e um conjunto de argumentos[^getting_started_with_r-1]. Para criar uma, usamos a fun√ß√£o `function`, seguindo esta estrutura:

[^getting_started_with_r-1]: Fun√ß√µes possuem complexidades adicionais, mas vamos manter a explica√ß√£o simples por enquanto. Se voc√™ ficar curioso mais tarde, confira [@wickham_advanced_2019, chap. 6] quando tiver mais experi√™ncia com o `r r_logo`.

```{r}
nome <- function(argumentos) {
  corpo
}
```

Vamos construir nossa fun√ß√£o de lan√ßamento de uma moeda passo a passo. Por enquanto, come√ßaremos sem usar argumentos:

```{r}
jogar_moeda <- function() {
  
  lados <- c("cara", "coroa")
  n_lancamentos <- 4
  com_reposicao <- TRUE
  lancamentos <- sample(x = lados, 
                        size = n_lancamentos, 
                        replace = com_reposicao)
  
  return(lancamentos)
}
```

::: callout-tip
Em uma fun√ß√£o bem estruturada, usamos a declara√ß√£o `return` no final do corpo para especificar explicitamente o valor que queremos que a fun√ß√£o retorne. Isso √© considerado uma boa pr√°tica na programa√ß√£o em `r r_logo`.
:::

Copie e cole o c√≥digo acima no console, pressione **Enter** e verifique a aba Ambiente (**Environment**, em ingl√™s) do RStudio IDE, como mostrado na @fig-running-toss-coin.

![Fun√ß√µes e aba Ambiente](images/running_toss_coin.png){#fig-running-toss-coin}

Agora vamos ver se a fun√ß√£o realmente funciona:

```{r}
jogar_moeda()
```

Voc√™ pode se perguntar: *Por que n√£o usar simplesmente `jogar_moeda`?* Vamos tentar e ver o que acontece:

```{r}
jogar_moeda
```

Nesse caso, o `r r_logo` vai te mostrar o c√≥digo da fun√ß√£o em vez de execut√°-la como faz quando voc√™ digita `jogar_moeda()`.

### Argumentos

Para tornar nossa fun√ß√£o mais flex√≠vel, vamos permitir que o usu√°rio especifique o n√∫mero de lan√ßamentos de moeda. Podemos fazer isso transformando n_lancamentos em um argumento da fun√ß√£o:

```{r}
jogar_moeda <- function(n_lancamentos) {
  
  lados <- c("cara", "coroa")
  com_reposicao <- TRUE
  lancamentos <- sample(x = lados, 
                        size = n_lancamentos, 
                        replace = com_reposicao)
  
  return(lancamentos)
}
```

Agora, o usu√°rio pode personalizar o n√∫mero de lan√ßamentos, especificando um valor maior ou igual a um. Vamos tentar com sete lan√ßamentos:

```{r}
jogar_moeda(n_lancamentos = 7)
```

Tamb√©m podemos definir valores padr√£o para os argumentos de uma fun√ß√£o. Esses valores ser√£o usados se o usu√°rio n√£o fornecer um valor, oferecendo flexibilidade e permitindo personaliza√ß√£o se necess√°rio. Vamos ilustrar essa op√ß√£o definindo um valor padr√£o para o argumento lados:

```{r}
jogar_moeda <- function(n_lancamentos, 
                        lados = c("cara", "coroa")) {
  
  com_reposicao <- TRUE
  lancamentos <- sample(x = lados, 
                        size = n_lancamentos, 
                        replace = com_reposicao)
  
  return(lancamentos)
}
```

Se o usu√°rio estiver satisfeito com as etiquetas "cara" e "coroa" para os lados da moeda, ent√£o podemos jogar uma moeda nove vezes da seguinte forma:

```{r}
jogar_moeda(n_lancamentos = 9)
```

No entanto, se o usu√°rio quiser alterar o valor do argumento lados, mudando seus valores para refletir os lados da moeda mostrados na @fig-coin-head-tail, podemos proceder da seguinte maneira:

```{r}
jogar_moeda(n_lancamentos = 9, lados = c("cabeca", "navio"))
```

A @fig-function-components, inspirada em [@grolemund_hands-programming_2015, chap. 1], ilustra os componentes de uma fun√ß√£o usando como exemplo `jogar_moeda`.

![Componentes de uma fun√ß√£o](images/function_components.png){#fig-function-components}

## Projetos no RStudio

### Por que usar projetos?

Quando voc√™ trabalha com dados (sejam reais ou simulados) ou aprende novos conceitos de estat√≠stica usando `r r_logo`, manter seus arquivos organizados √© fundamental. Os Projetos do RStudio oferecem uma √≥tima maneira de fazer isso! Veja o que significa organizar seu trabalho em projetos:

-   **Pasta de projeto dedicada**: Pense nela como um container especial para cada t√≥pico. Todos os seus arquivos relacionados (anota√ß√µes, c√≥digo, dados) ficam nesta pasta.

-   **Nomenclatura clara**: D√™ aos seus arquivos nomes descritivos para que voc√™ possa encontrar facilmente o que precisa depois.

-   **Seu ponto de partida**: Esta pasta se torna seu local de refer√™ncia para qualquer coisa relacionada a esse projeto.

Os projetos do RStudio ajudam a manter seu trabalho organizado e f√°cil de encontrar. Al√©m disso, voc√™ pode mover ou compartilhar facilmente um projeto inteiro, j√° que tudo fica junto.

Vamos come√ßar criando um projeto chamado **estatistica_descritiva** onde organizaremos nosso trabalho sobre a fun√ß√£o `jogar_moeda`.

### Como criar um projeto no RStudio

Projetos no RStudio podem ser criados de tr√™s formas diferentes:

-   Em um novo diret√≥rio
-   Em um diret√≥rio existente.
-   Clonando um reposit√≥rio de controle de vers√£o.

Vamos focar na cria√ß√£o de um projeto totalmente novo, ent√£o voc√™ n√£o precisa se preocupar com as outras op√ß√µes.

Para criar um novo projeto de RStudio:

-   Selecione **File > New Project**
-   Escolha a op√ß√£o **New Directory** (Veja @fig-create-project)
-   Selecione **New Project**, escolha onde salvar o seu projeto e nomeie-o como **estatistica_descritiva** (Veja @fig-project-type-directory-name)

![Cria√ß√£o de um projeto](images/create_project.png){#fig-create-project}

![Nome e localiza√ß√£o do projeto](images/project_type_directory_name.png){#fig-project-type-directory-name}

Se voc√™ seguir esses passos, uma pasta chamada **estatistica_descritiva** ser√° criada com um arquivo **estatistica_descritiva.Rproj** dentro dela. Para manter tudo organizado, crie uma nova pasta chamada **000_scripts** dentro da pasta do projeto. A estrutura do seu projeto agora deve se parecer com a @fig-initial-project-structure.

![Estrutura inicial do projeto](images/initial_project_structure.png){#fig-initial-project-structure}

### Trabalhando com projetos

Se fechar o RStudio IDE, para abrir o projeto e come√ßar a trabalhar nele, √© sempre necess√°rio seguir os passos abaixo:

-   Abra a pasta **estatistica_descritiva**
-   Clique duas vezes no arquivo **estatistica_descritiva.Rproj**

Sempre siga estes passos para come√ßar a trabalhar em seu projeto!

## Scripts

Escrever c√≥digo diretamente no console √© bom para testes r√°pidos, mas n√£o permite salvar seu trabalho facilmente. Scripts s√£o essenciais porque eles:

-   **Preservam o progresso**: Salve seu c√≥digo para us√°-lo novamente mais tarde sem ter que reescrever tudo.
-   **Documentam o processo**: Adicione anota√ß√µes e explica√ß√µes para ajudar voc√™ (e outros!) a entender seu c√≥digo no futuro.

Vamos come√ßar criando um script para a nossa fun√ß√£o `jogar_moeda`:

-   Selecione **File > New File > R Script**.
-   Copie e cole o c√≥digo da fun√ß√£o `jogar_moeda` neste script.
-   Salve o arquivo na sua pasta **000_scripts** e nomeie-o como **jogar_moeda.R**.

A estrutura do seu projeto agora deve se parecer com algo assim:

```
üì¶estadistica_descritiva
  |-üìÇ000_scripts
  |  |-üìújogar_moeda.R
  |-üìúestadistica_descritiva.Rproj
```

Al√©m disso, `r r_logo` e o RStudio IDE tornam f√°cil adicionar coment√°rios aos seus scripts das seguintes maneiras:

-   **Coment√°rios**: Comece uma linha com `#` e adicione seu coment√°rio.
-   **Se√ß√µes de c√≥digo**: Use quatro tra√ßos seguidos, `----`, para criar uma se√ß√£o.

Vamos documentar seu script **jogar_moeda.R** apontando o prop√≥sito e o valor de sa√≠da da fun√ß√£o `jogar_moeda`:

```{r}
#| eval: false

# Fun√ß√£o jogar_moeda ----

# Prop√≥sito ----
# Simular uma s√©rie de lan√ßamentos de uma moeda

# Sa√≠da ----
# Um vetor contendo os resultados de cada 
# lan√ßamento de uma moeda

jogar_moeda <- function(n_lancamentos, 
                        lados = c("cara", "coroa")) {
  
  com_reposicao <- TRUE
  lancamentos <- sample(x = lados, 
                        size = n_lancamentos, 
                        replace = com_reposicao)
  
  return(lancamentos)
}
```

Agora, seu script est√° bem documentado e f√°cil de entender. Este processo √© mostrado na @fig-documented-script usando o RStudio IDE.

![Script documentado](images/documented_script.png){#fig-documented-script}

## Pacotes

